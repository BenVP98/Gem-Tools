<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The StarForge Way: Interactive Onboarding</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .content-card {
            min-height: 420px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            transition: background-color 0.3s ease;
        }
        .progress-bar-inner {
            transition: width 0.3s ease-in-out;
        }
        .nav-button {
            transition: background-color 0.2s, transform 0.1s;
        }
        .nav-button:active {
            transform: scale(0.97);
        }
        .content-card ul {
            list-style-position: inside;
            padding-left: 1rem;
        }
        .content-card li {
            margin-bottom: 0.75rem;
        }
        .loader {
            border: 4px solid #4f46e5;
            border-top: 4px solid #a5b4fc;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-slate-900 text-white flex flex-col min-h-screen">

    <div class="flex-grow flex items-center justify-center p-4 sm:p-6">
        <div class="w-full max-w-3xl">
            <!-- Main Content Display -->
            <div id="content-display" class="bg-slate-800 border border-slate-700 rounded-2xl shadow-2xl p-8 sm:p-12 content-card">
                <!-- Content will be injected here -->
            </div>

            <!-- Navigation Controls -->
            <div class="mt-6 flex justify-between items-center">
                <button id="prev-btn" class="nav-button bg-slate-700 hover:bg-slate-600 text-white font-bold py-2 px-6 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed">
                    Previous
                </button>
                <button id="next-btn" class="nav-button bg-indigo-600 hover:bg-indigo-500 text-white font-bold py-2 px-8 rounded-lg">
                    Next
                </button>
            </div>
        </div>
    </div>

    <!-- Progress Bar Section -->
    <footer class="sticky bottom-0 w-full bg-slate-900 p-4 border-t border-slate-700">
        <div class="max-w-3xl mx-auto">
            <div class="flex justify-between items-center mb-1">
                <span class="text-sm font-medium text-slate-400">Your Onboarding Progress</span>
                <span id="progress-text" class="text-sm font-bold text-indigo-400">0%</span>
            </div>
            <div class="w-full bg-slate-700 rounded-full h-2.5">
                <div id="progress-bar-inner" class="bg-indigo-500 h-2.5 rounded-full" style="width: 0%"></div>
            </div>
        </div>
    </footer>

    <script>
        // --- The "StarForge Way" Knowledge Base ---
        const onboardingSteps = [
            {
                type: 'info',
                title: "⚔️ Welcome to StarForge",
                content: "<p class='text-xl text-slate-300'>This isn't just a manual; it's a field guide to how we operate, build, and win together. You're here because you believe in the mission: to give good operators better tools.</p><p class='mt-4 text-indigo-400 font-semibold'>Let's get started.</p>"
            },
            {
                type: 'info',
                title: "Part I: Our Driving Purpose",
                content: "<p><strong>We multiply human capacity, not replace it.</strong> We build for owner-operators in trades and small services—the people who never got the tools they deserve.</p><p class='mt-2'>Our promise is simple: <strong>'Multiply your workforce—no hiring required.'</strong> We turn complexity into relief.</p>"
            },
            {
                type: 'info',
                title: "What is 'Good Work' Here?",
                content: "<ul><li><strong>Visible:</strong> It ships and someone uses it.</li><li><strong>Thoughtful:</strong> It solves the root cause, not just the symptom.</li><li><strong>Repeatable:</strong> It can be turned into a process or system.</li><li><strong>Aligned:</strong> It directly supports our current goals.</li><li><strong>Fixed Fast:</strong> Mistakes are owned and corrected swiftly.</li></ul>"
            },
            {
                type: 'info',
                title: "Part II: Our Core Non-Negotiables",
                content: "<p>These are the values we are willing to 'bleed for.' They are the load-bearing walls of StarForge and must endure no matter how much we grow.</p>"
            },
            {
                type: 'info',
                title: "How We Handle Mistakes",
                content: "<p>Mistakes are part of the job. Hiding them isn't. We don't blame, we own. The ritual is: <strong>Own it fast → Share the root cause → Write the fix → Tell the team.</strong></p><p class='mt-2'>We fix systems, not people.</p>"
            },
            {
                type: 'scenario',
                title: "Scenario Check: Handling a Mistake",
                scenario: "You're working on a customer's project and realize you've made a mistake that will cause a one-day delay. No one else has noticed yet. What do you do?",
                principle: "The StarForge principle for handling mistakes is: Own it fast, share the root cause, write the fix, and tell the team. We fix systems, not people."
            },
            {
                type: 'info',
                title: "How We Handle Feedback",
                content: "<p>Feedback is a gift, not an attack. We follow a 4-step ladder: <strong>Listen without defense → Reflect openly → Decide visibly → Close the loop.</strong></p><p class='mt-2'>We always follow up. No black holes.</p>"
            },
            {
                type: 'scenario',
                title: "Scenario Check: Handling Feedback",
                scenario: "A customer tells you they're frustrated because a feature isn't working the way they expected. They seem annoyed. What's your first response?",
                principle: "The StarForge principle for handling feedback is: Listen without defense, reflect openly, decide visibly, and close the loop. It's about understanding, not justifying."
            },
            {
                type: 'info',
                title: "Part IV: How We Connect & Collaborate",
                content: "<p>This is the connective tissue of StarForge. It’s how we communicate, grow, and give a damn—without losing time, trust, or clarity.</p>"
            },
            {
                type: 'info',
                title: "Hierarchy & Voice",
                content: "<p>We have a hierarchy of <strong>responsibility</strong>, not of <strong>value</strong>. Leadership is a spotlight, not a throne. Every voice matters, and your proximity to a problem gives you insight the rest of us need.</p>"
            },
            {
                type: 'info',
                title: "You're Ready to Forge",
                content: "<p class='text-xl text-slate-300'>You now have the compass. This is a living system that we will all improve together. Welcome to the team.</p><p class='mt-4 font-bold text-indigo-400'>Build with care. Operate with clarity. Win with integrity.</p>"
            }
        ];

        // --- DOM Elements ---
        const contentDisplay = document.getElementById('content-display');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const progressBarInner = document.getElementById('progress-bar-inner');
        const progressText = document.getElementById('progress-text');

        // --- State ---
        let currentStep = 0;

        // --- Functions ---
        function renderStep() {
            const stepData = onboardingSteps[currentStep];
            contentDisplay.style.opacity = 0;

            setTimeout(() => {
                let html = '';
                if (stepData.type === 'info') {
                    html = `
                        <h2 class="text-2xl sm:text-3xl font-bold text-white mb-4">${stepData.title}</h2>
                        <div class="text-slate-300 space-y-4">${stepData.content}</div>
                    `;
                } else if (stepData.type === 'scenario') {
                    html = `
                        <h2 class="text-2xl sm:text-3xl font-bold text-white mb-4">${stepData.title}</h2>
                        <p class="text-slate-300 mb-4">${stepData.scenario}</p>
                        <textarea id="scenario-response" class="w-full p-3 bg-slate-900 border border-slate-600 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" rows="4" placeholder="How would you apply The StarForge Way here?"></textarea>
                        <button id="scenario-submit" class="mt-4 nav-button bg-orange-600 hover:bg-orange-500 text-white font-bold py-2 px-6 rounded-lg w-full sm:w-auto">✨ Check My Thinking</button>
                        <div id="scenario-feedback-container" class="mt-4"></div>
                    `;
                }
                contentDisplay.innerHTML = html;
                if (stepData.type === 'scenario') {
                    document.getElementById('scenario-submit').addEventListener('click', handleScenarioSubmit);
                }
                contentDisplay.style.opacity = 1;
            }, 150);

            updateProgressBar();
            updateNavButtons();
        }

        async function handleScenarioSubmit() {
            const stepData = onboardingSteps[currentStep];
            const responseTextarea = document.getElementById('scenario-response');
            const feedbackContainer = document.getElementById('scenario-feedback-container');
            const submitButton = document.getElementById('scenario-submit');
            const userAnswer = responseTextarea.value.trim();

            if (!userAnswer) {
                feedbackContainer.innerHTML = `<p class="text-red-400">Please enter your response first.</p>`;
                return;
            }

            submitButton.disabled = true;
            feedbackContainer.innerHTML = `<div class="flex items-center justify-center p-4"><div class="loader"></div></div>`;

            try {
                const fullPrompt = `
                    You are an encouraging and insightful onboarding coach for a company called StarForge.
                    A new hire is learning "The StarForge Way."
                    The relevant principle is: "${stepData.principle}"
                    The scenario presented was: "${stepData.scenario}"
                    The new hire's response is: "${userAnswer}"

                    Your task is to evaluate their response based ONLY on the provided principle. 
                    Start with encouragement. Then, explain what they did well and gently point out any areas for improvement, directly referencing the StarForge principle. Keep your feedback concise, friendly, and actionable (2-3 sentences).
                `;
                
                const payload = { contents: [{ role: "user", parts: [{ text: fullPrompt }] }] };
                const apiKey = "";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) throw new Error(`API Error: ${response.status}`);
                
                const result = await response.json();
                
                if (result.candidates && result.candidates[0].content.parts[0].text) {
                    const feedbackText = result.candidates[0].content.parts[0].text;
                    feedbackContainer.innerHTML = `<div class="bg-slate-700 p-4 rounded-lg border border-slate-600"><p class="text-slate-300">${feedbackText}</p></div>`;
                } else {
                    throw new Error("Invalid response structure from API.");
                }

            } catch (error) {
                console.error("Error getting feedback:", error);
                feedbackContainer.innerHTML = `<p class="text-red-400">Sorry, I couldn't get feedback right now. Please try again.</p>`;
            } finally {
                submitButton.disabled = false;
            }
        }

        function updateProgressBar() {
            const progressPercentage = Math.round(((currentStep + 1) / onboardingSteps.length) * 100);
            progressBarInner.style.width = `${progressPercentage}%`;
            progressText.textContent = `${progressPercentage}%`;
        }
        
        function updateNavButtons() {
            prevBtn.disabled = currentStep === 0;
            
            if (currentStep === onboardingSteps.length - 1) {
                nextBtn.textContent = 'Finish';
                nextBtn.classList.remove('bg-indigo-600', 'hover:bg-indigo-500');
                nextBtn.classList.add('bg-green-600', 'hover:bg-green-500');
            } else {
                nextBtn.textContent = 'Next';
                nextBtn.classList.remove('bg-green-600', 'hover:bg-green-500');
                nextBtn.classList.add('bg-indigo-600', 'hover:bg-indigo-500');
            }
        }

        // --- Event Listeners ---
        nextBtn.addEventListener('click', () => {
            if (currentStep < onboardingSteps.length - 1) {
                currentStep++;
                renderStep();
            } else {
                contentDisplay.innerHTML = `<h2 class="text-3xl font-bold text-white text-center">Welcome Aboard!</h2><p class="text-center mt-4 text-slate-300">You've completed the StarForge Way onboarding.</p>`;
                nextBtn.disabled = true;
                prevBtn.disabled = true;
            }
        });

        prevBtn.addEventListener('click', () => {
            if (currentStep > 0) {
                currentStep--;
                renderStep();
            }
        });

        // --- Initial Render ---
        renderStep();
    </script>
</body>
</html>
